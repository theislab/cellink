import os

# Configurations
#CHROMOSOMES = list(range(1, 23))  # Chromosomes 1 to 22
CHROMOSOMES = list(range(22, 23))  # test 22
INPUT_DIR = "/data/ceph/hdd/project/node_09/sys_gen_students/2024_2025/project04_rare_variant_sc/input_data/filter_vcf_r08"
OUTPUT_DIR = "/s/project/sys_gen_students/2024_2025/project04_rare_variant_sc/output"

rule all:
    input:
        expand(f"{OUTPUT_DIR}/chr{{chrom}}_all_results_DNA_LM_down_and_MAF_100k_test_10_genes.pkl", chrom=CHROMOSOMES)

# Rule to process each .vcz file
rule burden_testing:
    threads: 8
    input:
        vcz=lambda wildcards:(f"{INPUT_DIR}/chr{wildcards.chrom}.dose.filtered.R2_0.8.vcz")
    output:
        pkl=f"{OUTPUT_DIR}/chr{{chrom}}_all_results_DNA_LM_down_and_MAF_100k_test_10_genes.pkl",
    log:
        out="burden_testing_logs/{chrom}_stdout.log",
        err="burden_testing_logs/{chrom}_stderr.err"
    shell:
        """
        python run_burden_testing.py -c {wildcards.chrom} -i {input.vcz} -o {output.pkl}
        """
